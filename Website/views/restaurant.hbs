<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>LaSapp</title>
        <link rel="stylesheet" href="/views/restohbsstyle.css"/>
        <link href="https://fonts.googleapis.com/css2?family=Baloo&display=swap" rel="stylesheet"> 
        <script src = "javascript/web.js"></script>
        <img src="/views/CSS/RestoImages/logo.png" id="logoImg" alt="logo" height="70" width="70">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Funnel+Display:wght@300..800&family=Noto+Color+Emoji&family=Noto+Emoji:wght@300..700&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">

        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=search" />

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Funnel+Display:wght@300..800&family=Lexend:wght@100..900&family=Noto+Color+Emoji&family=Noto+Emoji:wght@300..700&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js"></script>
    </head>
    <body>
        <!-- Navigation Bar -->
        <header class="navbar">
            <!-- First Header -->
            <div class="navbar-container">
                <a href="/" id = "logoImg">
                <img src="/views/CSS/RestoImages/logo.png" alt="Logo" width="70" height="70">
                </a>
                    <div class="logo">LaSapp</div>
                
                
                <div class="options">
                    <ul>
                        <li><a href="/">DIRECTORY</a></li>
                        <li><a href="#">ACCOUNT</a></li>
                    </ul>
                </div>
            </div>
        </header>
                <div id="backdrop"></div>
        <div id="createRestoFrame">
            <div class="createResto-header">
                <h2>Edit Restaurant</h2>
            </div>
            <div class="createResto-content">
                <div class="wrapper">
                    <form name="restoForm" action="/api/submitupdate" method="post" enctype="multipart/form-data">
                        <!-- Basic Information -->
                        <input type="hidden" id="hidden-id" name="resto_id" value="{{restaurant.id}}">
                        <div class="form-section">
                            <h4>Basic Information</h4>
                            <div class="input-box">
                                <label for="resto-name">Restaurant Name</label>
                                <input type="text" id="resto-name" placeholder="Enter restaurant name" required>
                            </div>
                        </div>
                        
                        <!-- Address Section -->
                        <div class="form-section">
                            <h4>Location</h4>
                            <div class="input-box">
                                <label for="address1">Address Line 1</label>
                                <input type="text" id="address1" placeholder="Street address" required>
                            </div>
                            <div class="input-box">
                                <label for="address2">Address Line 2</label>
                                <input type="text" id="address2" placeholder="Building, floor, etc. (optional)">
                            </div>
                        </div>
                        
                        <!-- Operating Hours -->
                        <div class="form-section">
                            <h4>Operating Hours</h4>
                            <div class="input-box time-input">
                                <label for="opening-time">Opening Time</label>
                                <input type="time" id="opening-time" required>
                            </div>
                            <div class="input-box time-input">
                                <label for="closing-time">Closing Time</label>
                                <input type="time" id="closing-time" required>
                            </div>
                        </div>
                        
                        <!-- Contact Information -->
                        <div class="form-section">
                            <h4>Contact Information</h4>
                            <div class="input-box">
                                <label for="phone">Phone Number</label>
                                <input type="tel" id="phone" placeholder="Phone number" required>
                            </div>
                            <div class="input-box">
                                <label for="email">Email</label>
                                <input type="email" id="email" placeholder="Email address" required>
                            </div>
                        </div>
                        
                        <!-- Additional Information -->
                        <div class="form-section">
                            <h4>Additional Information</h4>
                            <div class="input-box">
                                <label for="payment">Payment Methods</label>
                                <input type="text" id="payment" placeholder="Cash, Credit Card, GCash, etc." required>
                            </div>
                            <div class="input-box">
                                <label for="perks">Perks</label>
                                <input type="text" id="perks" placeholder="Wi-Fi, Parking, etc." required>
                            </div>
                            <div class="input-box">
                                <label for="cuisine">Cuisine</label>
                                <input type="text" id="cuisine" placeholder="Filipino, Italian, Japanese, etc." required>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>Reference Image</h4>
                            <div class="input-box image-upload">
                                <label for="restaurant-images">Upload Reference Photo</label>
                               <input type="file" id="restaurant-images" name="image" accept="image/*">
                            </div>
                        </div>


                        <!-- Button Section stays inside the scrollable area but will be styled to stand out -->
                        <div class="button-section">
                            <div class="input-box button">
                                <input type="submit" id="updateSub" value="Update Restaurant">
                            </div>
                            <div class="input-box button secondary">
                                <input type="button" value="Cancel" onclick="togglePopupCreateResto()">
                            </div>
                        </div>
                    </form>
                </div>
        

                <button id="closeCreateResto" onclick="togglePopupCreateResto()">&times</button>
            </div>
        </div>

        <div id="deleteConfirmPopup">
            <div class="deleteConfirm-content">
                <div class="deleteConfirm-header">
                    <h2>Confirm Deletion</h2>
                </div>
                <div class="deleteConfirm-body">
                    <p>Are you sure you want to delete this restaurant?</p>
                    <p class="warning-text">This action cannot be undone.</p>
                    
                    <div class="confirm-buttons">
                        <button class="cancel-delete-btn" onclick="toggleDeleteConfirm()">Cancel</button>
                        <button class="confirm-delete-btn" onclick="deleteRestaurant()">Yes, Delete</button>
                    </div>
                </div>
                <button id="closeDeleteConfirm" onclick="toggleDeleteConfirm()">&times;</button>
            </div>
        </div>

        <div id="deleteReviewConfirmPopup">
            <div class="deleteConfirm-header">
                <h2>Delete Review</h2>
                <button id="closeDeleteReviewConfirm">&times;</button>
            </div>
            <div class="deleteConfirm-body">
                <p>Are you sure you want to delete this review?</p>
                <p class="warning-text">This action cannot be undone.</p>
                <div class="confirm-buttons">
                    <button class="cancel-delete-btn" id="cancelDeleteReview">Cancel</button>
                    <button class="confirm-delete-btn" id="confirmDeleteReview">Delete</button>
                </div>
            </div>
        </div>


        <!-- Restaurant Information -->
        <div class="info">
                <!-- Exit Button -->
                <div class="buttons-container">
                    <button class="oval-button-review delete-btn" onclick="toggleDeleteConfirm()">Delete</button>
                    <button class="oval-button-review edit-btn" onclick="togglePopupCreateResto()">Edit</button>
                    <a href="/">
                        <button class="oval-button-review">Back</button>
                    </a>
                </div>
                <!-- Header -->
                <div class="classheader">
                    <button onclick="toggleHeart()" id="btnh1" class="btn">
                        <i id="heartIcon" class="fa-solid fa-heart heart"></i>
                    </button>
                    <div class="head-container">
                        <h1>{{restaurant.name}}</h1>  
                        <p>{{restaurant.cuisine}}</p> 
                    </div>
                </div>       
            <!-- Main body-->
            <div class="main">
                <img src={{restaurant.image}} alt={{restaurant.name}}>
                <div class="information">
                    <h1>About:</h1>
                    <h2>📍 Address: </h2>
                    <p>{{restaurant.address}}</p>
                    <h2>⏰ Time: </h2>
                    <p>{{restaurant.time}}</p>
                    <h2>📱 Phone #: </h2>
                    <p>{{restaurant.phone}}</p>
                    <h2>📥 Email: </h2>
                    <p>{{restaurant.email}}</p>
                    <h2>💸 Payment Method: </h2>
                    <p>Cash, GCash, Debit Card</p>
                    <br>

                    <h1>Perks:</h1>
                    <ul>
                        {{#each restaurant.perks}}
                        <li>{{this}}</li>
                        {{/each}}
                    </ul>
                
                </div>
            </div>

            <!-- Reviews -->
            <div class="reviews">
            <div class="review1">
                <h1> Reviews</h1>

                <button class="button-3" onclick="toggleReviewModal()">Make a Review</button>
            
            </div>
            

            <div id="reviewModal">
                <div class="reviewModal-header">
                    <h2>Write a Review</h2>
                </div>
                <div class="reviewModal-content">
                    <div class="wrapper">
                        <form action="/api/addreview" name = "create-review" method="post">
                            <!-- Restaurant Name -->
                            <div class="form-section">
                                <h4>El Poco Cantina</h4>
                                
                                <!-- Rating Section -->
                                <div class="rating-container">
                                    <label>Your Rating:</label>
                                    <div class="star-rating">
                                        <span class="star" data-value="1">★</span>
                                        <span class="star" data-value="2">★</span>
                                        <span class="star" data-value="3">★</span>
                                        <span class="star" data-value="4">★</span>
                                        <span class="star" data-value="5">★</span>
                                    </div>
                                    <span id="rating-text">0 out of 5</span>
                                </div>
                            </div>
                            
                            <!-- Review Content -->
                            <div class="form-section">
                                <div class="input-box">
                                    <label for="review-content">Your Review</label>
                                    <textarea id="review-content" placeholder="Share your experience with this restaurant..." required></textarea>
                                </div>
                            </div>
            
                            <!-- Button Section -->
                            <div class="button-section">
                                <div class="input-box button">
                                    <input type="submit" id = 'submitReview' value="Submit Review">
                                </div>
                                <div class="input-box button secondary">
                                    <input type="button" value="Cancel" onclick="toggleReviewModal()">
                                </div>
                            </div>
                        </form>
                    </div>
                    <button id="closeReviewModal" onclick="toggleReviewModal()">&times;</button>
                </div>
            </div> 

            <div id="editReviewModal">
                <div class="reviewModal-header">
                    <h2>Edit Review</h2>
                </div>
                <div class="reviewModal-content">
                    <div class="wrapper">
                        <form action="/api/editreview" name="edit-review" method="post">
                            <!-- Restaurant Name -->
                            <div class="form-section">
                                <h4>{{restaurant.name}}</h4>
                                
                                <!-- Rating Section -->
                                <div class="rating-container">
                                    <label>Your Rating:</label>
                                    <div class="star-rating" id="edit-star-rating">
                                        <span class="star" data-value="1">★</span>
                                        <span class="star" data-value="2">★</span>
                                        <span class="star" data-value="3">★</span>
                                        <span class="star" data-value="4">★</span>
                                        <span class="star" data-value="5">★</span>
                                    </div>
                                    <span id="edit-rating-text">0 out of 5</span>
                                </div>
                            </div>
                            
                            <!-- Review Content -->
                            <div class="form-section">
                                <div class="input-box">
                                    <label for="edit-review-content">Your Review</label>
                                    <textarea id="edit-review-content" name="review" placeholder="Share your experience with this restaurant..." required></textarea>
                                </div>
                            </div>

                            <!-- Hidden input for review ID -->
                            <input type="hidden" id="edit-review-id" name="review_id" value="">
                    
                            <!-- Button Section -->
                            <div class="button-section">
                                <div class="input-box button">
                                    <input type="submit" id="submitEditReview" value="Update Review">
                                </div>
                                <div class="input-box button secondary">
                                    <input type="button" value="Cancel" onclick="toggleEditReviewModal()">
                                </div>
                            </div>
                        </form>
                    </div>
                    <button id="closeEditReviewModal" onclick="toggleEditReviewModal()">&times;</button>
                </div>
            </div>
                    
                <!-- Scrollable Reviews -->
                <div>
                    <div class="scroll-div"> 
                        <!-- Feed Reviews -->
                        {{#each reviews}}

                        <!-- Will only display the reviews if isAlive = true -->
                        <div class="scroll-obj">   
                            <h2>
                                <a href="/profile/{{this.account_id.acc_id}}">
                                <img src={{this.account_id.profile_pic}} alt="Profile" class="profile-pic"> 
                                {{this.account_id.acc_name}}
                                </a>

                                <button class="delete-review" data-id="{{this.review_id}}">🗑️</button> <!-- TO DO!! -->
                            </h2>
                            
                            <!-- Add star rating visualization (display actual rating when available) -->
                            <div class="review-rating">
                                ★★★★☆ <!-- Replace with dynamic stars based on rating -->
                            </div>
                            
                            <p>{{this.review}}</p>
                            
                            <!-- Add timestamp (use actual timestamp when available) -->
                            <span class="review-date">Posted on {{#if this.date}}{{this.date}}{{else}}{{/if}}</span>
                            
                            <!-- ADD FORMS FOR THIS -->
                            <div class="input-box button">
                                    <input type="hidden" id="hidden-review-id" name="review_id" value="{{this.review_id}}">
                                    <button type="button" id="Edit-Review-{{this.review_id}}" class="oval-button-review" onclick="openEditReview({{this.review_id}})">Edit</button>
                            </div>
                        </div>
                        {{/each}}
                    </div>
                </div>
            </div>      
        </div>

        <!-- Footer -->
        <footer>
            <img src="/views/CSS/RestoImages/logo.png" id="footerLogo" alt="logo" height="70" width="70">
            <div class="logo">LaSapp</div>

            <div class="footerIcon">
                <a href="https://www.facebook.com" target="_blank">
                    <img src="/views/CSS/RestoImages/icons/facebook.png" id="footerFacebook" alt="Facebook" width="30" height="30">
                </a>
                <a href="https://www.instagram.com" target="_blank">
                    <img src="/views/CSS/RestoImages/icons/instagram.png" id="footerIG" alt="Instagram" width="30" height="30">
                </a>
            </div>
        </footer>

        <script src="/javascript/RestoInfo.js"></script>
        <script>
            function toggleHeart() {
                const heartIcon = document.getElementById("heartIcon");
                heartIcon.classList.toggle("liked");

                if (heartIcon.classList.contains("liked")) {
                    heartIcon.style.color = "red";
                } else {
                    heartIcon.style.color = "gray";
                }
            }
        </script>
       <script src='/JavaScript/directoryScript.js'></script>
        <script src='/JavaScript/updateResto.js'></script>
        <script src='/JavaScript/deleteResto.js'></script>
        <script src='/JavaScript/addReview.js'></script>
        <script src='/JavaScript/editReview.js'></script>
        <script src ='/JavaScript/deleteReview.js'></script>
    </body>
</html>